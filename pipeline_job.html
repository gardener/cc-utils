

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pipeline Job &mdash; cc-utils  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />

  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Pipeline Steps" href="pipeline_step.html" />
    <link rel="prev" title="Pipeline Definition" href="pipeline.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            cc-utils
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="pipeline.html">Pipeline Definition</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Pipeline Job</a></li>
<li class="toctree-l1"><a class="reference internal" href="pipeline_step.html">Pipeline Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="traits.html">Pipeline Definition Traits</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes Process</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">cc-utils</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Pipeline Job</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/pipeline_job.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pipeline-job">
<h1>Pipeline Job<a class="headerlink" href="#pipeline-job" title="Link to this heading"></a></h1>
<p>Each <a class="reference internal" href="pipeline.html"><span class="doc">Build Pipeline</span></a> may define an arbitrary amount of build jobs. Job definitions
reside below a pipeline’s <code class="code docutils literal notranslate"><span class="pre">jobs</span></code> attribute. Each job defines their name as root element.</p>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>attribute</p></th>
<th class="head"><p>explanation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>&lt;name&gt;</p></td>
<td><p>the user-chosen job name.</p></td>
</tr>
<tr class="row-odd"><td><p>repo</p></td>
<td><p>main repository configuration</p></td>
</tr>
<tr class="row-even"><td><p>repos</p></td>
<td><p>optionally defines additional repositories</p></td>
</tr>
<tr class="row-odd"><td><p>steps</p></td>
<td><p>defines <a class="reference internal" href="pipeline_step.html"><span class="doc">Build Steps</span></a></p></td>
</tr>
<tr class="row-even"><td><p>traits</p></td>
<td><p>defines <a class="reference internal" href="traits.html"><span class="doc">Traits</span></a></p></td>
</tr>
</tbody>
</table>
</section>
<section id="github-repositories">
<h2>(GitHub) Repositories<a class="headerlink" href="#github-repositories" title="Link to this heading"></a></h2>
<section id="main-repository">
<h3>Main Repository<a class="headerlink" href="#main-repository" title="Link to this heading"></a></h3>
<p>Each pipeline has a main repository. It is implied by the GitHub repository from which the
pipeline definition was read.</p>
<ul class="simple">
<li><p>logical repository name defaults to <code class="code docutils literal notranslate"><span class="pre">source</span></code></p></li>
<li><p>branch and repo_path are determined by repository</p></li>
<li><p>repository path is implied by repository</p></li>
</ul>
</section>
<section id="additional-repositories">
<h3>Additional Repositories<a class="headerlink" href="#additional-repositories" title="Link to this heading"></a></h3>
<p>Additional repositories may be referenced. Different from the main repository, all of the
following attributes must be specified:</p>
<ul class="simple">
<li><p>logical repository name</p></li>
<li><p>branch name</p></li>
<li><p>repository path</p></li>
</ul>
</section>
<section id="repository-attributes">
<h3>Repository Attributes<a class="headerlink" href="#repository-attributes" title="Link to this heading"></a></h3>
<section id="repository-config">
<span id="repository-config"></span><h4>Attributes<a class="headerlink" href="#repository-config" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>required?</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>type</p></th>
<th class="head"><p>explanation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>no</p></td>
<td><p>source</p></td>
<td><p>str</p></td>
<td><p>the logical repository name. affects environment variable names and is used to reference
from traits.</p></td>
</tr>
<tr class="row-odd"><td><p>cfg_name</p></td>
<td><p>no</p></td>
<td><p>None</p></td>
<td><p>str</p></td>
<td><p>the github_cfg to use for authentication. Defaults to concourse-specific default</p></td>
</tr>
<tr class="row-even"><td><p>force_push</p></td>
<td><p>no</p></td>
<td><p>False</p></td>
<td><p>bool</p></td>
<td><p>whether or not force-pushes ought to be done</p></td>
</tr>
<tr class="row-odd"><td><p>trigger_paths</p></td>
<td><p>no</p></td>
<td><p><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">exclude</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
</pre></div>
</div>
</p></td>
<td><p>dict</p></td>
<td><p>repository paths to either ignore or to restrict triggering to</p></td>
</tr>
<tr class="row-even"><td><p>trigger</p></td>
<td><p>no</p></td>
<td><p>None</p></td>
<td><p>bool</p></td>
<td><p>overwrites the defaults for triggering behaviour</p></td>
</tr>
<tr class="row-odd"><td><p>disable_ci_skip</p></td>
<td><p>no</p></td>
<td><p>False</p></td>
<td><p>bool</p></td>
<td><p>whether to disable the ignoring of commits with [ci skip] in commit msg</p></td>
</tr>
<tr class="row-even"><td><p>branch</p></td>
<td><p>no</p></td>
<td><p>None</p></td>
<td><p>str</p></td>
<td><p>only for non-main repository: specify branch to work with</p></td>
</tr>
<tr class="row-odd"><td><p>path</p></td>
<td><p>no</p></td>
<td><p>None</p></td>
<td><p>str</p></td>
<td><p>github repository path (e.g. gardener/gardener)</p></td>
</tr>
<tr class="row-even"><td><p>hostname</p></td>
<td><p>no</p></td>
<td><p>None</p></td>
<td><p>str</p></td>
<td><p>do not use</p></td>
</tr>
<tr class="row-odd"><td><p>preferred_protocol</p></td>
<td><p>no</p></td>
<td><p>None</p></td>
<td><p>Protocol</p></td>
<td><p>optionally overwrites the preferred protocol to use</p></td>
</tr>
<tr class="row-even"><td><p>source_labels</p></td>
<td><p>no</p></td>
<td><p><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[]</span>
</pre></div>
</div>
</p></td>
<td><p>List[Label]</p></td>
<td><p>labels to add to the corresponding source declaration in base-component-descriptor</p></td>
</tr>
<tr class="row-odd"><td><p>submodule_cfg_names</p></td>
<td><p>no</p></td>
<td><p><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[]</span>
</pre></div>
</div>
</p></td>
<td><p>List[str]</p></td>
<td><p>The name of github configs to provide for authentication of submodules which are not stored
on the same git server as the repository.
The config used by the repository itself is included by default.
The configs given must support http-auth, otherwise they will be omitted.</p></td>
</tr>
</tbody>
</table>
<h4>preferred_protocol Enumeration Values<a class="headerlink" href="#repository-config" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ssh</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">https</span></code></p></li>
</ul>
<h4>source_labels[] <em>(Label)</em> Attributes<a class="headerlink" href="#repository-config" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>required?</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>type</p></th>
<th class="head"><p>explanation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>yes</p></td>
<td><p>None</p></td>
<td><p>str</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>value</p></td>
<td><p>yes</p></td>
<td><p>None</p></td>
<td><p>str | int | float | bool | dict | list</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>version</p></td>
<td><p>no</p></td>
<td><p>None</p></td>
<td><p>str | None</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>signing</p></td>
<td><p>no</p></td>
<td><p>False</p></td>
<td><p>bool</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="default-behaviour-for-trigger-attribute">
<h4>Default behaviour for <code class="code docutils literal notranslate"><span class="pre">trigger</span></code> attribute<a class="headerlink" href="#default-behaviour-for-trigger-attribute" title="Link to this heading"></a></h4>
<p>The <code class="code docutils literal notranslate"><span class="pre">trigger</span></code> attribute specifies whether or not head updates should trigger a job execution.</p>
<p>If it is not explicitly configured, the default behaviour is defined as follows:</p>
<ul class="simple">
<li><p>additional repositories default to <code class="code docutils literal notranslate"><span class="pre">false</span></code></p></li>
<li><p>main repository:</p>
<ul>
<li><p>presence of <code class="code docutils literal notranslate"><span class="pre">release</span></code> or <code class="code docutils literal notranslate"><span class="pre">cronjob</span></code> trait –&gt; <code class="code docutils literal notranslate"><span class="pre">false</span></code></p></li>
<li><p>presence of <code class="code docutils literal notranslate"><span class="pre">pull-request</span></code> trait –&gt; <code class="code docutils literal notranslate"><span class="pre">true</span></code></p></li>
<li><p>if none of the above traits are present –&gt; <code class="code docutils literal notranslate"><span class="pre">true</span></code></p></li>
</ul>
</li>
</ul>
</section>
<section id="trigger-paths-attribute">
<h4><code class="code docutils literal notranslate"><span class="pre">trigger_paths</span></code> attribute<a class="headerlink" href="#trigger-paths-attribute" title="Link to this heading"></a></h4>
<p>Allows to restrict build triggering by repository changes. If <code class="code docutils literal notranslate"><span class="pre">trigger</span></code> attribute evaluates to
<code class="code docutils literal notranslate"><span class="pre">false</span></code>, this attribute has no effect.</p>
<p>Using <code class="code docutils literal notranslate"><span class="pre">trigger_paths</span></code>, it is possible to ignore updates in case they touch (or do not touch)
certain repository paths (globbing syntax supported).</p>
<ul class="simple">
<li><p>include: only react on specified paths - ignore all others</p></li>
<li><p>exclude: ignore changes to specified paths (inverse of include)</p></li>
</ul>
</section>
<section id="cfg-names-attribute">
<h4><code class="code docutils literal notranslate"><span class="pre">cfg_names</span></code> attribute<a class="headerlink" href="#cfg-names-attribute" title="Link to this heading"></a></h4>
<p>Specifies the GitHub instance hosting the repository. For each Concourse instance, there is a
default GitHub instance that is used in case no <code class="code docutils literal notranslate"><span class="pre">cfg_name</span></code> is specified.</p>
<p>Available configurations are stored in a private configuration repository (<code class="code docutils literal notranslate"><span class="pre">kubernetes/cc-config</span></code>).</p>
<p>Valid cfg_names are:
- github_com
- github_wdf_sap_corp</p>
<section id="examples">
<h5>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>reference an additional repository <code class="code docutils literal notranslate"><span class="pre">github.com/foo/bar</span></code>, name it <code class="code docutils literal notranslate"><span class="pre">my_repo</span></code></p></li>
<li><p>the repository will be made available to builds at <code class="code docutils literal notranslate"><span class="pre">${MY_REPO_PATH}</span></code></p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">repos</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;my_repo&#39;</span>
<span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;foo/bar&#39;</span>
<span class="w">  </span><span class="nt">branch</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;master&#39;</span><span class="w">    </span><span class="c1"># must be specified - does not default to master</span>
<span class="w">  </span><span class="nt">cfg_name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;github_com&#39;</span>
</pre></div>
</div>
</section>
</section>
</section>
</section>
<section id="environment-variables">
<h2>Environment Variables<a class="headerlink" href="#environment-variables" title="Link to this heading"></a></h2>
<p>Depending on pipeline definition, build jobs are run with a set of environment variables.
The variables that are defined depend on:</p>
<ul class="simple">
<li><p>which repositories are defined (and their logical names)</p></li>
<li><p>which traits are defined</p></li>
</ul>
<p>In case user-specified identifiers are used as input to construct environment variable names,
those are converted to UPPER-case. Kebap-case is converted into snake-case (or in other words:
any occurrence of dash <code class="code docutils literal notranslate"><span class="pre">-</span></code> characters are converted to underscore <code class="code docutils literal notranslate"><span class="pre">_</span></code> characters).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For non-ASCII or non-alphanumeric characters, the behaviour is undefined. Usage of those
characters is forbidden for user-defined identifiers.</p>
</div>
<section id="environment-variables-from-repositories">
<span id="repository-environment-variables"></span><h3>Environment Variables from repositories<a class="headerlink" href="#environment-variables-from-repositories" title="Link to this heading"></a></h3>
<p>For each repository, the following environment variable set is defined:</p>
<ul class="simple">
<li><p>&lt;NAME&gt;_PATH -&gt; relative path to repository’s work tree</p></li>
<li><p>&lt;NAME&gt;_BRANCH -&gt; the configured branch</p></li>
<li><p>&lt;NAME&gt;_GITHUB_REPO_OWNER_AND_NAME -&gt; github_path (e.g. gardener/gardener)</p></li>
</ul>
<p>In addition, the <strong>relative</strong> path to the main repository is always stored in the
<code class="docutils literal notranslate"><span class="pre">MAIN_REPO_DIR</span></code> env variable.</p>
<section id="example">
<h4>Example<a class="headerlink" href="#example" title="Link to this heading"></a></h4>
<p>In case the main repository has not been explicitly configured with a name, its default logical
name is <code class="code docutils literal notranslate"><span class="pre">source</span></code>. Therefore, the following environment variables will then be defined:</p>
<ul class="simple">
<li><p>SOURCE_PATH</p></li>
<li><p>SOURCE_BRANCH</p></li>
<li><p>SOURCE_GITHUB_REPO_OWNER_AND_NAME</p></li>
<li><p>MAIN_REPO_DIR</p></li>
</ul>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pipeline.html" class="btn btn-neutral float-left" title="Pipeline Definition" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pipeline_step.html" class="btn btn-neutral float-right" title="Pipeline Steps" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2020, SAP SE or an SAP affiliate company..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>